# Super Nintendo Architecture

[Super Nintendo Architecture](https://www.copetti.org/writings/consoles/super-nintendo/)を翻訳したもの

## 導入

任天堂は、高価な既製品を使わずに、次世代のグラフィックとサウンドを実現しました。

そのため、スーパーファミコンは拡張性を重視した設計になっています。

CPUが光速で進化していく中で、任天堂がゲーム機を輝かせるためには、ゲームカートリッジによる拡張性が必要だったのです。

## CPU

メインプロセッサは、リコーの5A22です。これは、MOS Technology社の6502を16ビット化したWestern 65C816をベースにしています。

スーファミはファミコンのCPUと基盤を共有しているので、もともとファミコンのゲームとの互換性を考えていた可能性が少しあります。

CPUは可変クロックを採用しており、レジスタ操作時には最大3.58MHz、低速の外部バス（シリアル/コントローラポート）へのアクセス時には1.79MHzになります。

### 5A22の特徴

- 65816 ISA: オリジナルの6502 ISAを拡張した16ビット命令セットですが、ファミコンゲームが使用していた未定義の命令は実装されていません。
- 16bitレジスタ: アキュムレータ（算術演算を行う場所）とインデックスレジスタ（メモリアドレスの計算に使用）は、16bitモードと8bitモードを切り替えることができます。
- リコーが新たに追加した16ビットの乗算・除算ユニットにより、これらの演算をCPUがハードウェアで実行できるようになりました（65C816には乗算・除算の専用命令はありません）。
- 8bitの外部データバス: つまり、外部メモリ上でレジスタを移動させるのに、2倍のサイクルが必要になります。

### リコーによる改良

リコーは、レジスタの追加に加えて、CPUを介さずにメモリを移動させることができる2つの専用DMA(Direct Memory Access)をコア設計に組み込み、高速化を実現しました。

